<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://bytecodealliance.github.io/wamr.dev/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://bytecodealliance.github.io/wamr.dev/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://bytecodealliance.github.io/wamr.dev/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://bytecodealliance.github.io/wamr.dev/main.38cbab29a241a8ffa150452901bb274d4784732af0ecca917750a4b84906a34ddc38e2ed328382ca6f8d21261ddd21427b29ead40063b710689c39cec8663b0d.css integrity="sha512-OMurKaJBqP+hUEUpAbsnTUeEcyrw7MqRd1CkuEkGo03cOOLtMoOCym+NISYd3SFCeynq1ABjtxBonDnOyGY7DQ==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Introduction to WAMR running modes - WAMR</title><meta name=description content="The options of running a Wasm module # Usually, a WebAssembly module can be executed in either interpreter, Just-In-Time (JIT), or Ahead-Of-Time (AOT) compilation mode, and the choice can be based on the preference for execute performance, resource, etc.
WAMR supports all three modes and even more:
AOT: WAMR AOT helps to achieve nearly native speed, very small footprint, and quick startup. Use the wamrc compiler to compile wasm file to the AOT file, and then run it on iwasm vmcore."><link rel=canonical href=https://bytecodealliance.github.io/wamr.dev/blog/introduction-to-wamr-running-modes/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Introduction to WAMR running modes"><meta property="og:description" content="The options of running a Wasm module # Usually, a WebAssembly module can be executed in either interpreter, Just-In-Time (JIT), or Ahead-Of-Time (AOT) compilation mode, and the choice can be based on the preference for execute performance, resource, etc.
WAMR supports all three modes and even more:
AOT: WAMR AOT helps to achieve nearly native speed, very small footprint, and quick startup. Use the wamrc compiler to compile wasm file to the AOT file, and then run it on iwasm vmcore."><meta property="og:url" content="https://bytecodealliance.github.io/wamr.dev/blog/introduction-to-wamr-running-modes/"><meta property="og:site_name" content="WAMR"><meta property="article:published_time" content="2023-01-19T17:20:07+08:00"><meta property="article:modified_time" content="2023-01-28T17:20:07+08:00"><meta property="og:image" content="https://bytecodealliance.github.io/wamr.dev/wamr.png"><meta property="og:image:alt" content="WAMR"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content><meta name=twitter:creator content><meta name=twitter:title content="Introduction to WAMR running modes"><meta name=twitter:description content><meta name=twitter:image content="https://bytecodealliance.github.io/wamr.dev/wamr.png"><meta name=twitter:image:alt content="Introduction to WAMR running modes"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://bytecodealliance.github.io/#/schema/organization/1","name":"WAMR","url":"https://bytecodealliance.github.io/","sameAs":["https://github.com/bytecodealliance/wamr.dev"],"logo":{"@type":"ImageObject","@id":"https://bytecodealliance.github.io/#/schema/image/1","url":"https://bytecodealliance.github.io/logo-doks.png","width":512,"height":512,"caption":"WAMR"},"image":{"@id":"https://bytecodealliance.github.io/#/schema/image/1"}},{"@type":"WebSite","@id":"https://bytecodealliance.github.io/#/schema/website/1","url":"https://bytecodealliance.github.io/","name":"WAMR","description":"WebAssembly Micro Runtime (WAMR) is a lightweight standalone WebAssembly (WASM) runtime with small footprint, high performance and highly configurable features for applications cross from embedded, IoT, edge to Trusted Execution Environment (TEE), smart contract, cloud native and so on.","publisher":{"@id":"https://bytecodealliance.github.io/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://bytecodealliance.github.io/wamr.dev/blog/introduction-to-wamr-running-modes/","url":"https://bytecodealliance.github.io/wamr.dev/blog/introduction-to-wamr-running-modes/","name":"Introduction to WAMR running modes","description":"","isPartOf":{"@id":"https://bytecodealliance.github.io/#/schema/website/1"},"about":{"@id":"https://bytecodealliance.github.io/#/schema/organization/1"},"datePublished":"2023-01-19T17:20:07CET","dateModified":"2023-01-28T17:20:07CET","breadcrumb":{"@id":"https://bytecodealliance.github.io/wamr.dev/blog/introduction-to-wamr-running-modes/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://bytecodealliance.github.io/wamr.dev/blog/introduction-to-wamr-running-modes/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://bytecodealliance.github.io/wamr.dev/blog/introduction-to-wamr-running-modes/"]}]},{"@type":"BreadcrumbList","@id":"https://bytecodealliance.github.io/wamr.dev/blog/introduction-to-wamr-running-modes/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://bytecodealliance.github.io/wamr.dev/","url":"https://bytecodealliance.github.io/wamr.dev/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://bytecodealliance.github.io/wamr.dev/blog/","url":"https://bytecodealliance.github.io/wamr.dev/blog/","name":"Blog"}},{"@type":"ListItem","position":3,"item":{"@id":"https://bytecodealliance.github.io/wamr.dev/blog/introduction-to-wamr-running-modes/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://bytecodealliance.github.io/#/schema/article/1","headline":"Introduction to WAMR running modes","description":"","isPartOf":{"@id":"https://bytecodealliance.github.io/wamr.dev/blog/introduction-to-wamr-running-modes/"},"mainEntityOfPage":{"@id":"https://bytecodealliance.github.io/wamr.dev/blog/introduction-to-wamr-running-modes/"},"datePublished":"2023-01-19T17:20:07CET","dateModified":"2023-01-28T17:20:07CET","author":{"@id":"https://bytecodealliance.github.io/#/schema/person/2"},"publisher":{"@id":"https://bytecodealliance.github.io/#/schema/organization/1"},"image":{"@id":"https://bytecodealliance.github.io/wamr.dev/blog/introduction-to-wamr-running-modes/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://bytecodealliance.github.io/#/schema/person/2","name":null,"sameAs":[]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://bytecodealliance.github.io/wamr.dev/blog/introduction-to-wamr-running-modes/#/schema/image/2","url":"https://bytecodealliance.github.io/wamr.dev/wamr.png","contentUrl":"https://bytecodealliance.github.io/wamr.dev/wamr.png","caption":"Introduction to WAMR running modes"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://bytecodealliance.github.io/wamr.dev/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=https://bytecodealliance.github.io/wamr.dev/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=https://bytecodealliance.github.io/wamr.dev/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://bytecodealliance.github.io/wamr.dev/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://bytecodealliance.github.io/wamr.dev/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://bytecodealliance.github.io/wamr.dev/site.webmanifest></head><body class="blog single"><div class=sticky-top><style>.brand{position:relative;float:left;left:10px;z-index:1;padding:16px 0;text-decoration:none;color:#333}.brand:hover{filter:brightness(60%)}</style><div class=header-bar></div><header class="navbar navbar-expand-lg navbar-light doks-navbar"><div><a href=https://bytecodealliance.org/ class=brand><img src=https://bytecodealliance.github.io/wamr.dev//bytecode-alliance-logo.svg alt="Bytecode Alliance logo" width=164></a></div><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=https://bytecodealliance.github.io/wamr.dev/ aria-label=WAMR>WAMR</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>WAMR</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class=nav-item><a class="nav-link ps-0 py-1 active" href=/wamr.dev/blog/>Blog</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/wamr.dev/events/>Events</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/wamr.dev/resources/>Resources</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://github.com/bytecodealliance/wasm-micro-runtime><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><button id=mode class="btn btn-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></div></div></nav></header></div><div class="wrap container-xxl" role=document><div class=content><article><div class="row justify-content-center"><div class="col-md-12 col-lg-10"><div class=blog-header><h1>Introduction to WAMR running modes</h1><p><small>Posted&nbsp;in&nbsp;<a class="stretched-link position-relative link-muted" href=https://bytecodealliance.github.io/wamr.dev/categories/introduction/>introduction</a>&nbsp;on&nbsp;January 19, 2023 by <a class="stretched-link position-relative" href=https://bytecodealliance.github.io/wamr.dev/contributors/tianlong-liang/>Tianlong Liang</a>&nbsp;&dash;&nbsp;<strong>5&nbsp;min read</strong></small><p></div></div><div class=col-md-13><div></div></div><div class="col-md-12 col-lg-12"><h2 id=the-options-of-running-a-wasm-module>The options of running a Wasm module <a href=#the-options-of-running-a-wasm-module class=anchor aria-hidden=true>#</a></h2><p>Usually, a WebAssembly module can be executed in either interpreter, Just-In-Time (JIT), or Ahead-Of-Time (AOT) compilation mode, and the choice can be based on the preference for execute performance, resource, etc.</p><p>WAMR supports all three modes and even more:</p><ul><li><strong>AOT</strong>: WAMR AOT helps to achieve nearly native speed, very <strong>small footprint</strong>, and <strong>quick startup</strong>. Use the wamrc compiler to compile wasm file to the AOT file, and then run it on iwasm vmcore.</li><li><strong>Interpreter</strong>: Small footprint, small memory consumption, and relatively slow. WAMR offers two interpreters:<ul><li><strong>Classic Interpreter (CI)</strong>: A textbook implementation of Wasm interpreter. It is currently needed for supporting source debugging.</li><li><strong>Fast Interpreter (FI)</strong>: Precompile the Wasm opcode to internal opcode and runs ~2X faster than the classic interpreter, but it consumes a bit more memory than CI.</li></ul></li><li><strong>JIT</strong>: Run Wasm at nearly native speed yet keeps Wasm as distribution media which is platform-agnostic. The cost is compilation during execution. WAMR supports two JIT layers:<ul><li><strong>LLVM JIT</strong>: Based on LLVM framework and offer the best execution <strong>performance</strong>. Its cost is the longer compilation time.</li><li><strong>Fast JIT</strong>: A lightweight JIT engine with a small footprint, quick <strong>startup</strong>, yet good performance. Currently, it supports x86-64 arch and Linux/Linux-SGX/MacOS platforms.</li></ul></li></ul><p><strong>JIT layers tier-up on the fly</strong>: WAMR supports switching from Fast JIT to LLVM JIT during Wasm execution, which provides both a quick cold start with Fast JIT and excellent performance with LLVM JIT.<br><img class="img-fluid lazyload blur-up" srcset="/wamr.dev/blog/introduction-to-wamr-running-modes/wamr_jit_tier_up_hu269dae37814c6dec2718e576a7eaa5e0_15599_424x0_resize_q75_h2_box_3.webp 424w" sizes=80vw src=/wamr.dev/blog/introduction-to-wamr-running-modes/wamr_jit_tier_up_hu269dae37814c6dec2718e576a7eaa5e0_15599_424x0_resize_q75_h2_box_3.webp width=424 height=122></p><h2 id=the-considerations-of-wasm-execution-mode>The considerations of Wasm execution mode <a href=#the-considerations-of-wasm-execution-mode class=anchor aria-hidden=true>#</a></h2><p>When you use WAMR in your products, there are a few things that should be considered about the Wasm execution mode:</p><ol><li>At compilation time, what execution engines should be compiled in?</li><li>At running time, how to determine the execution mode for a loaded Wasm module?</li></ol><h3 id=compile-the-engines>Compile the engines <a href=#compile-the-engines class=anchor aria-hidden=true>#</a></h3><p>Except that the Fast Interpreter can&rsquo;t co-exist with other execution engines in a software binary, all other execution engines can be built into single software at any combination.</p><p>WAMR offers several CMake cache variables for the compilation control of the execution engines:</p><table><thead><tr><th>Execution Engine</th><th>CMake cache variable</th></tr></thead><tbody><tr><td>AOT</td><td>WAMR_BUILD_AOT=1</td></tr><tr><td>Classic Interpreter</td><td>WAMR_BUILD_INTERP=1, WAMR_BUILD_FAST_INTERP=0</td></tr><tr><td>Fast Interpreter</td><td>WAMR_BUILD_INTERP=1, WAMR_BUILD_FAST_INTERP=1</td></tr><tr><td>LLVM JIT</td><td>WAMR_BUILD_JIT=1</td></tr><tr><td>Fast JIT</td><td>WAMR_BUILD_FAST_JIT=1</td></tr></tbody></table><p>Note: Building LLVM JIT and Fast JIT will automatically include the Classic Interpreter since they depend on CI. It means when WAMR_BUILD_JIT or WAMR_BUILD_FAST_JIT is enabled for CMAKE, WAMR_BUILD_INTERP will be turned on automatically.</p><p>The example of CMake build command below compiles the Classic Interpreter, LLVM JIT, and Fast JIT Execution engine into the runtime binary.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>cmake -DWAMR_BUILD_INTERP<span class=o>=</span><span class=m>1</span> -DWAMR_BUILD_JIT<span class=o>=</span><span class=m>1</span> -DWAMR_BUILD_FAST_JIT<span class=o>=</span><span class=m>1</span> -B build
</span></span></code></pre></div><h3 id=control-the-execution-mode>Control the execution mode <a href=#control-the-execution-mode class=anchor aria-hidden=true>#</a></h3><p>The software that embeds the WAMR can fully control what execution mode for a loaded Wasm module, by calling the runtime APIs.</p><ul><li><p>set runtime default mode:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-C data-lang=C><span class=line><span class=cl><span class=c1>// query whether a running mode is supported:
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>bool</span> <span class=nf>wasm_runtime_is_running_mode_supported</span><span class=p>(</span><span class=n>RunningMode</span> <span class=n>runnnig_mode</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// set the default running mode for the entire runtime(for all module instances):
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>bool</span> <span class=nf>wasm_runtime_set_default_running_mode</span><span class=p>(</span><span class=n>RunningMode</span> <span class=n>runnnig_mode</span><span class=p>);</span>
</span></span></code></pre></div></li><li><p>set module instance:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-C data-lang=C><span class=line><span class=cl><span class=c1>// set the default running mode for a module instance
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>bool</span> <span class=nf>wasm_runtime_set_running_mode</span><span class=p>(</span><span class=kt>wasm_module_inst_t</span> <span class=n>module_inst</span><span class=p>,</span> <span class=n>RunningMode</span> <span class=n>running_mode</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// get the running mode for a module instance
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>RunningMode</span> <span class=nf>wasm_runtime_get_running_mode</span><span class=p>(</span><span class=kt>wasm_module_inst_t</span> <span class=n>module_inst</span><span class=p>);</span>
</span></span></code></pre></div></li><li><p>definition of running mode:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-C data-lang=C><span class=line><span class=cl><span class=k>typedef</span> <span class=k>enum</span> <span class=n>RunningMode</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Mode_Interp</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>     <span class=c1>// interpreter
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Mode_Fast_JIT</span><span class=p>,</span>       <span class=c1>// fast jit
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Mode_LLVM_JIT</span><span class=p>,</span>       <span class=c1>// llvm jit
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>Mode_Multi_Tier_JIT</span><span class=p>,</span> <span class=c1>// multi-tier jit
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span> <span class=n>RunningMode</span><span class=p>;</span>
</span></span></code></pre></div></li></ul><p>Notes:</p><ol><li>The running mode is supported only when the underlying execution engine is built into the binary.</li><li>The <code>Mode_Multi_Tier_JIT</code> enables tier-up from Fast JIT to LLVM JIT. It is supported only when both Fast JIT and LLVM JIT are available.</li><li>The selection between fast interpreter and classic interpreter is determined at compilation time, since only one interpreter can be built into the binary.</li></ol><p><strong>The priority of choosing running mode:</strong></p><ol><li>User set the mode of a module instance</li><li>User set the default mode of the whole runtime</li><li>If the user didn&rsquo;t set it at runtime or instance levels, the following selection order will be used:<br>(1) The JIT layers tier-up on the fly if both JIT layers are available<br>(2) LLVM JIT execution, if available<br>(3) Fast JIT execution, if available<br>(4) Interpreter</li></ol><p><strong>A simple usage of APIs:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-C data-lang=C><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=n>init_args</span><span class=p>.</span><span class=n>running_mode</span> <span class=o>=</span> <span class=n>Mode_Fast_JIT</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=c1>// initialize the default running mode for entire runtime(all module instance)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>wasm_runtime_full_init</span><span class=p>(</span><span class=o>&amp;</span><span class=n>init_args</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=c1>// alternatively, you could set the default running mode the later
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>wasm_runtime_set_default_running_mode</span><span class=p>(</span><span class=n>Mode_Interp</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=n>buffer</span> <span class=o>=</span> <span class=nf>bh_read_file_to_buffer</span><span class=p>(</span><span class=s>&#34;a.wasm&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>size</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>module</span> <span class=o>=</span> <span class=nf>wasm_runtime_load</span><span class=p>(</span><span class=n>buffer</span><span class=p>,</span> <span class=n>size</span><span class=p>,</span> <span class=n>error_buf</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>error_buf</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=n>module_inst</span> <span class=o>=</span> <span class=nf>wasm_runtime_instantiate</span><span class=p>(</span><span class=n>module</span><span class=p>,</span> <span class=n>stack_size</span><span class=p>,</span> <span class=n>heap_size</span><span class=p>,</span><span class=n>error_buf</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>error_buf</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=c1>// will run in default running mode
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>wasm_runtime_call_wasm</span><span class=p>(</span><span class=n>exec_env</span><span class=p>,</span> <span class=n>a_func</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>wasm_argv</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=n>buffer_b</span> <span class=o>=</span> <span class=nf>bh_read_file_to_buffer</span><span class=p>(</span><span class=s>&#34;b.wasm&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>size</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>module_b</span> <span class=o>=</span> <span class=nf>wasm_runtime_load</span><span class=p>(</span><span class=n>buffer_b</span><span class=p>,</span> <span class=n>size</span><span class=p>,</span> <span class=n>error_buf</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>error_buf</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=n>module_inst_b</span> <span class=o>=</span> <span class=nf>wasm_runtime_instantiate</span><span class=p>(</span><span class=n>module_b</span><span class=p>,</span> <span class=n>stack_size</span><span class=p>,</span> <span class=n>heap_size</span><span class=p>,</span><span class=n>error_buf</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>error_buf</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nf>wasm_runtime_set_running_mode</span><span class=p>(</span><span class=n>module_inst_b</span><span class=p>,</span> <span class=n>Mode_Multi_Tier_JIT</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=c1>// will run in user set module instance running mode
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nf>wasm_runtime_call_wasm</span><span class=p>(</span><span class=n>exec_env</span><span class=p>,</span> <span class=n>b_func</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>wasm_argv</span><span class=p>);</span>
</span></span></code></pre></div><h2 id=try-out-iwasm-from-wamr-binary-release>Try out iwasm from WAMR binary release <a href=#try-out-iwasm-from-wamr-binary-release class=anchor aria-hidden=true>#</a></h2><blockquote><p>Note: Release version before(including) 1.1.2 doesn&rsquo;t have this feature.</p></blockquote><p>Since the release version 1.2.0(<strong>upcoming</strong>), if you want to have a quick try, it would be a good option to download the WAMR from the <a href=https://github.com/bytecodealliance/wasm-micro-runtime/releases>binary release</a> and start the iwasm command.</p><p>An alternative way to try is to compile iwasm directly, use the following commands to compile <code>iwasm</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># in directory {WAMR Directory}/product-mini/platforms/{your platform}</span>
</span></span><span class=line><span class=cl>mkdir -p build
</span></span><span class=line><span class=cl>cmake -DWAMR_BUILD_JIT<span class=o>=</span><span class=m>1</span> -DWAMR_BUILD_FAST_JIT<span class=o>=</span><span class=m>1</span> -B build
</span></span><span class=line><span class=cl>cmake --build build
</span></span></code></pre></div><p>There are four command line options to control the running modes of iwasm:</p><ul><li><code>--interp</code>: run iwasm in classic interpreter mode</li><li><code>--fast-jit</code>: run iwasm in fast jit mode</li><li><code>--llvm-jit</code>: run iwasm in llvm jit mode</li><li><code>--multi-tier-jit</code>: run iwasm in multi-tier jit mode</li></ul><p>Command examples:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1># default mode: multi-tier jit will be run</span>
</span></span><span class=line><span class=cl>iwasm test.wasm
</span></span><span class=line><span class=cl><span class=c1># or could explicitly run multi-tier jit</span>
</span></span><span class=line><span class=cl>iwasm --multi-tier-jit test.wasm
</span></span><span class=line><span class=cl><span class=c1># choose to run llvm jit mode</span>
</span></span><span class=line><span class=cl>iwasm --llvm-jit --llvm-jit-opt-level<span class=o>=</span><span class=m>3</span> test.wasm
</span></span><span class=line><span class=cl><span class=c1># choose to run fast jit mode</span>
</span></span><span class=line><span class=cl>iwasm --fast-jit test.wasm
</span></span><span class=line><span class=cl><span class=c1># choose to run interpreter mode</span>
</span></span><span class=line><span class=cl>iwasm --interp test.wasm
</span></span></code></pre></div><div class=card><div class=card-header>Interested in WAMR?</div><div class=card-body><div class=row><a style=margin-top:10px href=https://bytecodealliance.zulipchat.com/#narrow/stream/290350-wamr><img src=https://img.shields.io/badge/zulip-join_chat-brightgreen.svg></a>
<a style=margin-top:10px href=https://github.com/bytecodealliance/wasm-micro-runtime><img alt="GitHub Repo stars" src="https://img.shields.io/github/stars/bytecodealliance/wasm-micro-runtime?label=WAMR%C2%B7Stars&style=social"></a>
<a style=margin-top:10px href=https://github.com/bytecodealliance/wasm-micro-runtime/fork><img alt="GitHub forks" src="https://img.shields.io/github/forks/bytecodealliance/wasm-micro-runtime?label=WAMR%C2%B7Forks&style=social"></a></div></div></div></div></div></article><div class=related-posts><div class="row justify-content-center"><div class=col><h2 class=section-title>Related posts</h2></div></div><div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-lg-5"><div class=col><div class=card><img class="card-img-top img-fluid lazyload blur-up" src=https://bytecodealliance.github.io/wamr.dev/images/webassembly-pic_hufbeecd7296df170cb8eea885384f41c3_20814_6d8a2b6aa74b933b123f4287214ddce8.webp data-src=https://bytecodealliance.github.io/wamr.dev/images/webassembly-pic_hufbeecd7296df170cb8eea885384f41c3_20814_1270x620_resize_q75_h2_box_3.webp width=1270 height=620 alt="Understand the WAMR stacks"><div class=card-body><article><h2 class=h3><a class="stretched-link text-body" href=/wamr.dev/blog/understand-the-wamr-stacks/>Understand the WAMR stacks</a></h2><p></p><p><small>Posted&nbsp;in&nbsp;<a class="stretched-link position-relative link-muted" href=https://bytecodealliance.github.io/wamr.dev/categories/introduction/>introduction</a>&nbsp;on&nbsp;March 18, 2023 by <a class="stretched-link position-relative" href=https://bytecodealliance.github.io/wamr.dev/contributors/xin-wang/>Xin Wang</a> and <a class="stretched-link position-relative" href=https://bytecodealliance.github.io/wamr.dev/contributors/wenyong-huang/>Wenyong Huang</a>&nbsp;&dash;&nbsp;<strong>3&nbsp;min read</strong></small><p></article></div></div></div><div class=col><div class=card><img class="card-img-top img-fluid lazyload blur-up" src=https://bytecodealliance.github.io/wamr.dev/images/webassembly-pic_hufbeecd7296df170cb8eea885384f41c3_20814_6d8a2b6aa74b933b123f4287214ddce8.webp data-src=https://bytecodealliance.github.io/wamr.dev/images/webassembly-pic_hufbeecd7296df170cb8eea885384f41c3_20814_1270x620_resize_q75_h2_box_3.webp width=1270 height=620 alt="Understand the WAMR heap"><div class=card-body><article><h2 class=h3><a class="stretched-link text-body" href=/wamr.dev/blog/understand-the-wamr-heap/>Understand the WAMR heap</a></h2><p></p><p><small>Posted&nbsp;in&nbsp;<a class="stretched-link position-relative link-muted" href=https://bytecodealliance.github.io/wamr.dev/categories/introduction/>introduction</a>&nbsp;on&nbsp;March 17, 2023 by <a class="stretched-link position-relative" href=https://bytecodealliance.github.io/wamr.dev/contributors/xin-wang/>Xin Wang</a> and <a class="stretched-link position-relative" href=https://bytecodealliance.github.io/wamr.dev/contributors/wenyong-huang/>Wenyong Huang</a>&nbsp;&dash;&nbsp;<strong>3&nbsp;min read</strong></small><p></article></div></div></div></div></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a class=text-muted href=https://gohugo.io/>Hugo</a>, and <a class=text-muted href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=/wamr.dev/js/bootstrap.min.650aeec64c81d69d4c0850fc73c93da3f0330cec0a27772feed7f90f60baa5f47f1c45687d71914bdafd1c4e860d40f6dc08ede27a2f08431ff929c9a2d24621.js integrity="sha512-ZQruxkyB1p1MCFD8c8k9o/AzDOwKJ3cv7tf5D2C6pfR/HEVofXGRS9r9HE6GDUD23Ajt4novCEMf+SnJotJGIQ==" crossorigin=anonymous defer></script>
<script src=/wamr.dev/js/highlight.min.6efdec8375dd620e0a357860aafeb5c97c7b51f33c9c594d57fa7f76cf22d2a6e0e39f8127dfed74d737512bfdb23f641827578b3fe09da15442a003c878a033.js integrity="sha512-bv3sg3XdYg4KNXhgqv61yXx7UfM8nFlNV/p/ds8i0qbg45+BJ9/tdNc3USv9sj9kGCdXiz/gnaFUQqADyHigMw==" crossorigin=anonymous defer></script>
<script src=/wamr.dev/main.min.cb2e2ebbf2e4002f3117addc33582923b2b3ae5265c22944cd117ebec7abe61c170417c4506d7a0f8f0fc9053dfdf441421d53601ac467042ff3d06ec0ba07fa.js integrity="sha512-yy4uu/LkAC8xF63cM1gpI7KzrlJlwilEzRF+vser5hwXBBfEUG16D48PyQU9/fRBQh1TYBrEZwQv89BuwLoH+g==" crossorigin=anonymous defer></script>
<script src=https://bytecodealliance.github.io/wamr.dev/index.min.4ae26272486ea46c5bb0bed7a0b434a91b05e8182cfb839a405dd4e647b05ce5d76d401a5103d822d3b1589fc56335cd372b712d97085b8d89aebf244b1b5501.js integrity="sha512-SuJickhupGxbsL7XoLQ0qRsF6Bgs+4OaQF3U5kewXOXXbUAaUQPYItOxWJ/FYzXNNytxLZcIW42Jrr8kSxtVAQ==" crossorigin=anonymous defer></script></body></html>